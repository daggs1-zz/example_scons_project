import utils

Import('env')

utils_env = utils.init_utils_env(env)

pkg_name = 'busybox'
utils.prepare_env(utils_env, pkg_name)
dir = Dir(utils_env['unpacked_path'] + '/' + utils.get_stages_folder_name())

stages = [
	  (dir.abspath + '/unpacked', utils.unpack), 
	  (dir.abspath + '/patched', utils.patch),
	  #(dir.abspath + '/prepared', utils.prepare),
	  #(dir.abspath + '/compiled', utils.compile),
	  #(dir.abspath + '/installed', utils.install)
	 ]

prev = None

for stage in stages:
	(target, func) = stage
	utils_env.Command(target, prev, [ func(utils_env, pkg_name), Touch("${TARGET.abspath}") ])
	prev = target
	
